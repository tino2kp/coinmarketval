<?php
	//1Falta handle errores
	//2Falta hacer iteración con los símbolos y que matcheen en $sql where realsymbol:arreglar liasons
	include_once 'dbconnection.php';
	set_time_limit(0);
	$connection = new PDOconnectionMVC();
	$con = $connection -> connectionDB();

	$ethscanlink= array('0x6810e776880c02933d47db1b9fc05908e5386b96','0xe94327d07fc17907b4db788e5adf2ed424addff6');//GNOSIS GNO, AUGUR REP
	//$ethscanlink= array('0x006BeA43Baa3f7A6f765F14f10A1a1b08334EF45','0x036407F23D5E1C1486F7488332CF54bf06E5F09F','0x08d32b0da63e2C3bcF8019c9c5d849d7a9d791e6','0x0affa06e7fbe5bc9a764c979aa66e8256a631f02','0x0b1724cc9fda0186911ef6a75949e9c0d3f0f2f3','0x11025bAcDbF00e033880c95262bF501a62235F2E','0x12fef5e57bf45873cd9b62e9dbd7bfb99e32d73e','0x1776e1F26f98b1A5dF9cD347953a26dd3Cb46671','0x1a95b271b0535d15fa49932daba31ba612b52946','0x1a986F1659e11E2AE7CC6543F307bAE5cDe1C761','0x27f706edde3aD952EF647Dd67E24e38CD0803DD6','0x2a05d22db079bc40c2f77a1d1ff703a56e631cc1','0x2bdc0d42996017fce214b21607a515da41a9e0c5','0x2e071D2966Aa7D8dECB1005885bA1977D6038A65','0x2fe6ab85ebbf7776fee46d191ee4cea322cecf51','0x3597bfd533a99c9aa083587b074434e61eb0a258','0x37a9679c41e99db270bda88de8ff50c0cd23f326','0x386467f1f3ddbe832448650418311a479eecfc57','0x422866a8F0b032c5cf1DfBDEf31A20F4509562b0','0x4470bb87d77b963a013db939be332f927f2b992e','0x45e42D659D9f9466cD5DF622506033145a9b89Bc','0x4993CB95c7443bdC06155c5f5688Be9D8f6999a5','0x4DF812F6064def1e5e029f1ca858777CC98D2D81','0x4fE6Ea636aBe664E0268Af373A10CA3621A0B95b','0x56ba2Ee7890461f463F7be02aAC3099f6d5811A8','0x59061b6f26BB4A9cE5828A19d35CFD5A4B80F056','0x5a84969bb663fb64F6d015DcF9F622Aedc796750','0x5af2be193a6abca9c8817001f45744777db30756','0x5c6183d10a00cd747a6dbb5f658ad514383e9419','0x667088b212ce3d06a1b553a7221E1fD19000d9aF','0x671abbe5ce652491985342e85428eb1b07bc6c64','0x68aa3f232da9bdc2343465545794ef3eea5209bd','0x697beac28b09e122c4332d163985e8a73121b97f','0x701c244b988a513c945973defa05de933b23fe1d','0x7Dc4f41294697a7903C4027f6Ac528C5d14cd7eB','0x82665764ea0b58157e1e5e9bab32f68c76ec0cdf','0x8aA33A7899FCC8eA5fBe6A608A109c3893A1B8b2','0x8ae4bf2c33a8e667de34b54938b0ccd03eb8cc06','0x8f3470a7388c05ee4e7af3d01d8c722b0ff52374','0x93e682107d1e9defb0b5ee701c71707a4b2e46bc','0x949bEd886c739f1A3273629b3320db0C5024c719','0x9653cfd0865ad8313bea2f0c2ec0584bfd05115b','0x983f6d60db79ea8ca4eb9968c6aff8cfa04b3c63','0xa33e729bf4fdeb868b534e1f20523463d9c46bee','0xa54ddc7b3cce7fc8b1e3fa0256d0db80d2c10970','0xa645264C5603E96c3b0B078cdab68733794B0A71','0xAc709FcB44a43c35F0DA4e3163b117A17F3770f5','0xaE616e72D3d89e847f74E8ace41Ca68bbF56af79','0xaec98a708810414878c3bcdf46aad31ded4a4557','0xAef38fBFBF932D1AeF3B808Bc8fBd8Cd8E1f8BC5','0xb110ec7b1dcb8fab8dedbf28f53bc63ea5bedd84','0xb24754be79281553dc1adc160ddf5cd9b74361a4','0xB802b24E0637c2B87D2E8b7784C055BBE921011a','0xB8c77482e45F1F44dE1745F52C74426C631bDD52','0xc1e6c6c681b286fb503b36a9dd6c1dbff85e73cf','0xc63e7b1dece63a77ed7e4aeef5efb3b05c81438d','0xCA29db4221c111888a7e80b12eAc8a266Da3Ee0d','0xcb97e65f07da24d46bcdd078ebebd7c6e6e3d750','0xcc4ef9eeaf656ac1a2ab886743e98e97e090ed38','0xcced5b8288086be8c38e23567e684c3740be4d48','0xce5c603c78d047ef43032e96b5b785324f753a4f','0xd4fa1460f537bb9085d22c7bccb5dd450ef28e3a','0xD65960FAcb8E4a2dFcb2C2212cb2e44a02e2a57E','0xe2e6d4be086c6938b53b22144855eef674281639','0xe3818504c1b32bf1557b16c238b2e01fd3149c17','0xea1f346faf023f974eb5adaf088bbcdf02d761f4','0xf3d29fb98d2dc5e78c87198deef99377345fd6f1','0xF4134146AF2d511Dd5EA8cDB1C4AC88C57D60404','0xF433089366899D83a9f26A773D59ec7eCF30355e','0xfca47962d45adfdfd1ab2d972315db4ce7ccf094','0xfd399192a8dc99aad26052be7db95ffacc17f11c','0xd0d6d6c5fe4a677d343cc433536bb717bae167dd','0x960b236A07cf122663c4303350609A66A7B288C0','0x1f573d6fb3f13d689ff844b4ce37794d79a7ff1c','0x0d8775f648430679a709e98d2b0cb6250d2887ef','0xff3519eeeea3e76f1f699ccce5e23ee0bdda41ac','0x96A65609a7B84E8842732DEB08f56C3E21aC6f8a','0x41e5560054824ea6b0732e656e3ad64e20e94e45','0xe0b7927c4af23765cb51314a0e0521a9645f0e2a','0x0abdace70d3790235af448c88547603b945604ea','0x08711d3b02c8758f2fb3ab4e80228418a7f8e39c','0x86fa049857e0209aa7d9e616f7eb3b3b78ecfdb0','0xaf30d2a7e90d7dc361c8c4585e9bb7d2f6f15bc7','0x88FCFBc22C6d3dBaa25aF478C578978339BDe77a','0x419d0d8bdd9af5e606ae2232ed285aff190e711b','0x6810e776880c02933d47db1b9fc05908e5386b96','0xa74476443119A942dE498590Fe1f2454d7D4aC0d','0xf7b098298f7c69fc14610bf71d5e02c60792894c','0xcbcc0f036ed4788f63fc0fee32873d6a7487b908','0x888666CA69E0f178DED6D75b5726Cee99A87D698','0x7654915a1b82d6d2d0afc37c52af556ea8983c7e','0xfa05A73FfE78ef8f1a739473e462c54bae6567D9','0xBEB9eF514a379B997e0798FDcC901Ee474B6D9A1','0xb63b606ac810a52cca15e44bb630fd42d8d1d83d','0xcfb98637bcae43C13323EAa1731cED2B716962fD','0xd26114cd6EE289AccF82350c8d8487fedB8A0C07','0xD8912C10681D8B21Fd3742244f44658dBA12264E','0x9a642d6b3368ddc662CA244bAdf32cDA716005BC','0xe94327d07fc17907b4db788e5adf2ed424addff6','0x607F4C5BB672230e8672085532f7e901544a7375','0x7c5a0ce9267ed19b22f8cae653f198e3e8daf098','0xaec2e87e0a235266d9c5adc9deb4b2e29b54d009','0x744d70fdbe2ba4cf95131626614a1763df805b9e','0xb64ef51c888972c908cfacf59b47c1afbc0ab8ac','0xb9e7f8568e08d5659f5d29c4997173d84cdf2607','0xe7775a6e9bcf904eb39da2b68c5efb4f9360e08c','0xB97048628DB6B661D4C2aA833e95Dbe1A905B280','0x6531f133e6deebe7f2dce5a0441aa7ef330b4e53','0xaaaf91d9b90df800df4f55c205fd6989c977e73a','0xcb94be6f13a1182e4a4b6140cb7bf2025d28e41b','0x5c543e7AE0A1104f78406C340E9C64FD9fCE5170','0xe41d2489571d322189246dafa5ebde1f4699f498');
	$realsymbol = array('STX','ABC','DCN','PLBT','RIYA','ETX','CFI','NMR','MNE','UNY','UET','BAS','SKIN','DICE','CDT','DENT','YOC','MBRS','ADST','ADX','NXC','ROUND','XAUR','ETB','CAT','LGD','ICE','BQX','NXX','WINGS','QAU','MSP','QRL','OAX','RMC','VSM','BET','PTOY','VERI','MCAP','AMIS','FXE','SNM','ICO','NDC','MYST','ARC','GOOD','300','CRB','XID','XRL','EMV','BNB','JET','FUCK','BLN','BTM','DDF','RLT','E4ROW','PPT','SOAR','LNK','PLR','TIX','BPC','SNC','MTL','IXT','GUC','ADT','ANT','BNT','BAT','BCAP','CTR','CVC','DGD','DNT','EDG','EOS','1ST','FYN','FUN','GNO','GNT','GUP','HMQ','ICN','IFT','LUN','MLN','MCO','NET','OMG','PLU','QTUM','REP','RLC','SAN','SNGLS','SNT','STORJ','SWT','TAAS','PAY','TIME','TKN','TRST','VSL','ZRX');
	foreach ($ethscanlink as $link)
	{
		$url = 'https://etherscan.io/token/tokenholderchart/'.$link.'';
		$content = file_get_contents($url);
		$first_step = explode('The Top 100 holders collectively own ', $content );
		$second_step = explode("</p>" , $first_step[1] );
		//echo $second_step[0];
		$pattern = '/\((.*)(?= Tokens)/';
		preg_match($pattern, $url, $output_array);
		//echo $output_array;
		$hits = 0;
		if(preg_match($pattern, $first_step, $hits)){
		$count1= count($hits);
		echo $count1;
		echo $hits;
	}
	}
	/*
	$curl = curl_init();
	curl_setopt($curl,CURLOPT_URL,'https://etherscan.io/token/tokenholderchart/0x006BeA43Baa3f7A6f765F14f10A1a1b08334EF45');
	curl_setopt($curl,CURLOPT_CONNECTTIMEOUT,2);
	$result = curl_exec($curl);
	print $result;
	*/
	/*
	$subject="https://etherscan.io/token/tokenholderchart/0x6810e776880c02933d47db1b9fc05908e5386b96";
	$pattern = '/\((.*)(?= Tokens)/';
	$hits = 0;
	if(preg_match($pattern, $subject, $hits)){
	$count1= count($hits);
	print $count1;
	print_r $hits;
		}
	*/
?>